/* esm.sh - esbuild bundle(@lezer/highlight@0.16.0) deno production */
import{NodeProp as J}from"/v117/@lezer/common@0.16.1/deno/common.mjs";var L=0,h=class{constructor(e,a,i){this.set=e,this.base=a,this.modified=i,this.id=L++}static define(e){if(e?.base)throw new Error("Can not derive from a modified tag");let a=new h([],null,[]);if(a.set.push(a),e)for(let i of e.set)a.set.push(i);return a}static defineModifier(){let e=new M;return a=>a.modified.indexOf(e)>-1?a:M.get(a.base||a,a.modified.concat(e).sort((i,n)=>i.id-n.id))}},Q=0,M=class{constructor(){this.instances=[],this.id=Q++}static get(e,a){if(!a.length)return e;let i=a[0].instances.find(r=>r.base==e&&U(a,r.modified));if(i)return i;let n=[],l=new h(n,e,a);for(let r of a)r.instances.push(l);let c=V(a);for(let r of e.set)for(let d of c)n.push(M.get(r,d));return l}};function U(o,e){return o.length==e.length&&o.every((a,i)=>a==e[i])}function V(o){let e=[o];for(let a=0;a<o.length;a++)for(let i of V(o.slice(0,a).concat(o.slice(a+1))))e.push(i);return e}function Z(o){let e=Object.create(null);for(let a in o){let i=o[a];Array.isArray(i)||(i=[i]);for(let n of a.split(" "))if(n){let l=[],c=2,r=n;for(let u=0;;){if(r=="..."&&u>0&&u+3==n.length){c=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(r);if(!f)throw new RangeError("Invalid path: "+n);if(l.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==n.length)break;let p=n[u++];if(u==n.length&&p=="!"){c=0;break}if(p!="/")throw new RangeError("Invalid path: "+n);r=n.slice(u)}let d=l.length-1,g=l[d];if(!g)throw new RangeError("Invalid path: "+n);let m=new q(i,c,d>0?l.slice(0,d):null);e[g]=m.sort(e[g])}}return z.add(e)}var z=new J,q=class{constructor(e,a,i,n){this.tags=e,this.mode=a,this.context=i,this.next=n}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};function W(o,e){let a=Object.create(null);for(let l of o)if(!Array.isArray(l.tag))a[l.tag.id]=l.class;else for(let c of l.tag)a[c.id]=l.class;let{scope:i,all:n=null}=e||{};return{style:l=>{let c=n;for(let r of l)for(let d of r.set){let g=a[d.id];if(g){c=c?c+" "+g:g;break}}return c},scope:i}}function X(o,e){let a=null;for(let i of o){let n=i.style(e);n&&(a=a?a+" "+n:n)}return a}function $(o,e,a,i=0,n=o.length){let l=new P(i,Array.isArray(e)?e:[e],a);l.highlightRange(o.cursor(),i,n,"",l.highlighters),l.flush(n)}var P=class{constructor(e,a,i){this.at=e,this.highlighters=a,this.span=i,this.class=""}startSpan(e,a){a!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=a)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,a,i,n,l){let{type:c,from:r,to:d}=e;if(r>=i||d<=a)return;c.isTop&&(l=this.highlighters.filter(p=>!p.scope||p.scope(c)));let g=n,m=c.prop(z),u=!1;for(;m;){if(!m.context||e.matchContext(m.context)){let p=X(l,m.tags);p&&(g&&(g+=" "),g+=p,m.mode==1?n+=(n?" ":"")+p:m.mode==0&&(u=!0));break}m=m.next}if(this.startSpan(e.from,g),u)return;let f=e.tree&&e.tree.prop(J.mounted);if(f&&f.overlay){let p=e.node.enter(f.overlay[0].from+r,1),G=this.highlighters.filter(v=>!v.scope||v.scope(f.tree.type)),D=e.firstChild();for(let v=0,O=r;;v++){let S=v<f.overlay.length?f.overlay[v]:null,E=S?S.from+r:d,H=Math.max(a,O),K=Math.min(i,E);if(H<K&&D)for(;e.from<K&&(this.highlightRange(e,H,K,n,l),this.startSpan(Math.min(i,e.to),g),!(e.to>=E||!e.nextSibling())););if(!S||E>i)break;O=S.to+r,O>a&&(this.highlightRange(p.cursor(),Math.max(a,S.from+r),Math.min(i,O),n,G),this.startSpan(O,g))}D&&e.parent()}else if(e.firstChild()){do if(!(e.to<=a)){if(e.from>=i)break;this.highlightRange(e,a,i,n,l),this.startSpan(Math.min(i,e.to),g)}while(e.nextSibling());e.parent()}}},t=h.define,R=t(),N=t(),B=t(N),F=t(N),x=t(),I=t(x),T=t(x),y=t(),w=t(y),k=t(),b=t(),j=t(),A=t(j),C=t(),s={comment:R,lineComment:t(R),blockComment:t(R),docComment:t(R),name:N,variableName:t(N),typeName:B,tagName:t(B),propertyName:F,attributeName:t(F),className:t(N),labelName:t(N),namespace:t(N),macroName:t(N),literal:x,string:I,docString:t(I),character:t(I),attributeValue:t(I),number:T,integer:t(T),float:t(T),bool:t(x),regexp:t(x),escape:t(x),color:t(x),url:t(x),keyword:k,self:t(k),null:t(k),atom:t(k),unit:t(k),modifier:t(k),operatorKeyword:t(k),controlKeyword:t(k),definitionKeyword:t(k),moduleKeyword:t(k),operator:b,derefOperator:t(b),arithmeticOperator:t(b),logicOperator:t(b),bitwiseOperator:t(b),compareOperator:t(b),updateOperator:t(b),definitionOperator:t(b),typeOperator:t(b),controlOperator:t(b),punctuation:j,separator:t(j),bracket:A,angleBracket:t(A),squareBracket:t(A),paren:t(A),brace:t(A),content:y,heading:w,heading1:t(w),heading2:t(w),heading3:t(w),heading4:t(w),heading5:t(w),heading6:t(w),contentSeparator:t(y),list:t(y),quote:t(y),emphasis:t(y),strong:t(y),link:t(y),monospace:t(y),strikethrough:t(y),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta:C,documentMeta:t(C),annotation:t(C),processingInstruction:t(C),definition:h.defineModifier(),constant:h.defineModifier(),function:h.defineModifier(),standard:h.defineModifier(),local:h.defineModifier(),special:h.defineModifier()},_=W([{tag:s.link,class:"tok-link"},{tag:s.heading,class:"tok-heading"},{tag:s.emphasis,class:"tok-emphasis"},{tag:s.strong,class:"tok-strong"},{tag:s.keyword,class:"tok-keyword"},{tag:s.atom,class:"tok-atom"},{tag:s.bool,class:"tok-bool"},{tag:s.url,class:"tok-url"},{tag:s.labelName,class:"tok-labelName"},{tag:s.inserted,class:"tok-inserted"},{tag:s.deleted,class:"tok-deleted"},{tag:s.literal,class:"tok-literal"},{tag:s.string,class:"tok-string"},{tag:s.number,class:"tok-number"},{tag:[s.regexp,s.escape,s.special(s.string)],class:"tok-string2"},{tag:s.variableName,class:"tok-variableName"},{tag:s.local(s.variableName),class:"tok-variableName tok-local"},{tag:s.definition(s.variableName),class:"tok-variableName tok-definition"},{tag:s.special(s.variableName),class:"tok-variableName2"},{tag:s.definition(s.propertyName),class:"tok-propertyName tok-definition"},{tag:s.typeName,class:"tok-typeName"},{tag:s.namespace,class:"tok-namespace"},{tag:s.className,class:"tok-className"},{tag:s.macroName,class:"tok-macroName"},{tag:s.propertyName,class:"tok-propertyName"},{tag:s.operator,class:"tok-operator"},{tag:s.comment,class:"tok-comment"},{tag:s.meta,class:"tok-meta"},{tag:s.invalid,class:"tok-invalid"},{tag:s.punctuation,class:"tok-punctuation"}]);export{h as Tag,_ as classHighlighter,X as highlightTags,$ as highlightTree,Z as styleTags,W as tagHighlighter,s as tags};
//# sourceMappingURL=highlight.mjs.map