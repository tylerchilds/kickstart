/* esm.sh - esbuild bundle(@codemirror/language@0.20.2) deno production */
import{NodeProp as y,Tree as p,IterMode as Vt,TreeFragment as U,Parser as gt,NodeType as J,NodeSet as zt}from"/v117/@lezer/common@0.16.1/deno/common.mjs";import{StateEffect as K,StateField as ot,Facet as k,EditorState as O,countColumn as Gt,combineConfig as kt,RangeSet as bt,RangeSetBuilder as wt,Prec as qt}from"/v117/@codemirror/state@0.20.1/deno/state.mjs";import{ViewPlugin as lt,logException as Ht,Decoration as v,EditorView as w,WidgetType as Jt,gutter as Kt,GutterMarker as Qt}from"/v117/@codemirror/view@0.20.7/deno/view.mjs";import{tags as f,tagHighlighter as Xt,highlightTree as Yt,styleTags as Zt}from"/v117/@lezer/highlight@0.16.0/deno/highlight.mjs";import{StyleModule as ft}from"/v117/style-mod@4.0.3/deno/style-mod.mjs";var Z,T=new y;function yt(n){return k.define({combine:n?t=>t.concat(n):void 0})}var c=class{constructor(t,e,r=[]){this.data=t,O.prototype.hasOwnProperty("tree")||Object.defineProperty(O.prototype,"tree",{get(){return m(this)}}),this.parser=e,this.extension=[P.of(this),O.languageData.of((i,s,o)=>i.facet(ut(i,s,o)))].concat(r)}isActiveAt(t,e,r=-1){return ut(t,e,r)==this.data}findRegions(t){let e=t.facet(P);if(e?.data==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(T)==this.data){r.push({from:o,to:o+s.length});return}let a=s.prop(y.mounted);if(a){if(a.tree.prop(T)==this.data){if(a.overlay)for(let l of a.overlay)r.push({from:l.from+o,to:l.to+o});else r.push({from:o,to:o+s.length});return}else if(a.overlay){let l=r.length;if(i(a.tree,a.overlay[0].from+o),r.length>l)return}}for(let l=0;l<s.children.length;l++){let h=s.children[l];h instanceof p&&i(h,s.positions[l]+o)}};return i(m(t),0),r}get allowsNesting(){return!0}};c.setState=K.define();function ut(n,t,e){let r=n.facet(P);if(!r)return null;let i=r.data;if(r.allowsNesting)for(let s=m(n).topNode;s;s=s.enter(t,e,Vt.ExcludeBuffers))i=s.type.prop(T)||i;return i}var N=class extends c{constructor(t,e){super(t,e),this.parser=e}static define(t){let e=yt(t.languageData);return new N(e,t.parser.configure({props:[T.add(r=>r.isTop?e:void 0)]}))}configure(t){return new N(this.data,this.parser.configure(t))}get allowsNesting(){return this.parser.hasWrappers()}};function m(n){let t=n.field(c.state,!1);return t?t.tree:p.empty}function _t(n,t,e=50){var r;let i=(r=n.field(c.state,!1))===null||r===void 0?void 0:r.context;return i&&(i.isDone(t)||i.work(e,t))?i.tree:null}function ze(n,t=n.doc.length){var e;return((e=n.field(c.state,!1))===null||e===void 0?void 0:e.context.isDone(t))||!1}function Ge(n,t=n.viewport.to,e=100){let r=_t(n.state,t,e);return r!=m(n.state)&&n.dispatch({}),!!r}function qe(n){var t;return((t=n.plugin(xt))===null||t===void 0?void 0:t.isWorking())||!1}var et=class{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let r=this.cursorPos-this.string.length;return t<r||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-r,e-r)}},I=null,x=class{constructor(t,e,r=[],i,s,o,a,l){this.parser=t,this.state=e,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,r){return new x(t,e,[],p.empty,0,r,[],null)}startParse(){return this.parser.startParse(new et(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=p.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof t=="number"){let i=Date.now()+t;t=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(U.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(U.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=I;I=this;try{return t()}finally{I=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=ct(t,e.from,e.to);return t}changes(t,e){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!t.empty){let l=[];if(t.iterChangedRanges((h,u,d,g)=>l.push({fromA:h,toA:u,fromB:d,toB:g})),r=U.applyChanges(r,l),i=p.empty,s=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){a=[];for(let h of this.skipped){let u=t.mapPos(h.from,1),d=t.mapPos(h.to,-1);u<d&&a.push({from:u,to:d})}}}return new x(this.parser,e,r,i,s,o,a,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<t.to&&s>t.from&&(this.fragments=ct(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends gt{createParse(e,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let l=I;if(l){for(let h of i)l.tempSkipped.push(h);t&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,t]):t)}return this.parsedPos=o,new p(J.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return I}};function ct(n,t,e){return U.applyChanges(n,[{fromA:t,toA:e,fromB:t,toB:e}])}var S=class{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),r=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,r)||e.takeTree(),new S(e)}static init(t){let e=Math.min(3e3,t.doc.length),r=x.create(t.facet(P).parser,t,{from:0,to:e});return r.work(20,e)||r.takeTree(),new S(r)}};c.state=ot.define({create:S.init,update(n,t){for(let e of t.effects)if(e.is(c.setState))return e.value;return t.startState.facet(P)!=t.state.facet(P)?S.init(t.state):n.apply(t)}});var vt=n=>{let t=setTimeout(()=>n(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(vt=n=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(n,{timeout:500-100})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});var _=typeof navigator<"u"&&(!((Z=navigator.scheduling)===null||Z===void 0)&&Z.isInputPending)?()=>navigator.scheduling.isInputPending():null,xt=lt.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(c.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(c.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=vt(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(c.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!_?Math.max(25,t.timeRemaining()-5):1e9),a=s.context.treeLen<i&&r.doc.length>i+1e3,l=s.context.work(()=>_&&_()||Date.now()>o,i+(a?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:c.setState.of(new S(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Ht(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),P=k.define({combine(n){return n.length?n[0]:null},enables:[c.state,xt]}),dt=class{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}},L=class{constructor(t,e,r,i,s,o=void 0){this.name=t,this.alias=e,this.extensions=r,this.filename=i,this.loadFunc=s,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(t=>this.support=t,t=>{throw this.loading=null,t}))}static of(t){let{load:e,support:r}=t;if(!e){if(!r)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(r)}return new L(t.name,(t.alias||[]).concat(t.name).map(i=>i.toLowerCase()),t.extensions||[],t.filename,e,r)}static matchFilename(t,e){for(let i of t)if(i.filename&&i.filename.test(e))return i;let r=/\.([^.]+)$/.exec(e);if(r){for(let i of t)if(i.extensions.indexOf(r[1])>-1)return i}return null}static matchLanguageName(t,e,r=!0){e=e.toLowerCase();for(let i of t)if(i.alias.some(s=>s==e))return i;if(r)for(let i of t)for(let s of i.alias){let o=e.indexOf(s);if(o>-1&&(s.length>2||!/\w/.test(e[o-1])&&!/\w/.test(e[o+s.length])))return i}return null}},St=k.define(),Pt=k.define({combine:n=>{if(!n.length)return"  ";if(!/^(?: +|\t+)$/.test(n[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return n[0]}});function j(n){let t=n.facet(Pt);return t.charCodeAt(0)==9?n.tabSize*t.length:t.length}function te(n,t){let e="",r=n.tabSize;if(n.facet(Pt).charCodeAt(0)==9)for(;t>=r;)e+="	",t-=r;for(let i=0;i<t;i++)e+=" ";return e}function ee(n,t){n instanceof O&&(n=new $(n));for(let r of n.state.facet(St)){let i=r(n,t);if(i!=null)return i}let e=m(n.state);return e?re(n,e,t):null}var $=class{constructor(t,e={}){this.state=t,this.options=e,this.unit=j(t)}lineAt(t,e=1){let r=this.state.doc.lineAt(t),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=r.from&&i<=r.to?s&&i==t?{text:"",from:t}:(e<0?i<t:i<=t)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(t,e);return r.slice(t-i,Math.min(r.length,t+100-i))}column(t,e=1){let{text:r,from:i}=this.lineAt(t,e),s=this.countColumn(r,t-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(t,e=t.length){return Gt(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:r,from:i}=this.lineAt(t,e),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},ne=new y;function re(n,t,e){return At(t.resolveInner(e).enterUnfinishedNodesBefore(e),e,n)}function ie(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function se(n){let t=n.type.prop(ne);if(t)return t;let e=n.firstChild,r;if(e&&(r=e.type.prop(y.closedBy))){let i=n.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>Ct(o,!0,1,void 0,s&&!ie(o)?i.from:void 0)}return n.parent==null?oe:null}function At(n,t,e){for(;n;n=n.parent){let r=se(n);if(r)return r(M.create(e,t,n))}return null}function oe(){return 0}var M=class extends ${constructor(t,e,r){super(t.state,t.options),this.base=t,this.pos=e,this.node=r}static create(t,e,r){return new M(t,e,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let t=this.state.doc.lineAt(this.node.from);for(;;){let e=this.node.resolve(t.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(le(e,this.node))break;t=this.state.doc.lineAt(e.from)}return this.lineIndent(t.from)}continue(){let t=this.node.parent;return t?At(t,this.pos,this.base):0}};function le(n,t){for(let e=t;e;e=e.parent)if(n==e)return!0;return!1}function ae(n){let t=n.node,e=t.childAfter(t.from),r=t.lastChild;if(!e)return null;let i=n.options.simulateBreak,s=n.state.doc.lineAt(e.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let a=e.to;;){let l=t.childAfter(a);if(!l||l==r)return null;if(!l.type.isSkipped)return l.from<o?e:null;a=l.to}}function Je({closing:n,align:t=!0,units:e=1}){return r=>Ct(r,t,e,n)}function Ct(n,t,e,r,i){let s=n.textAfter,o=s.match(/^\s*/)[0].length,a=r&&s.slice(o,o+r.length)==r||i==n.pos+o,l=t?ae(n):null;return l?a?n.column(l.from):n.column(l.to):n.baseIndent+(a?0:n.unit*e)}var Ke=n=>n.baseIndent;function Qe({except:n,units:t=1}={}){return e=>{let r=n&&n.test(e.textAfter);return e.baseIndent+(r?0:t*e.unit)}}var he=200;function Xe(){return O.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let t=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!t.length)return n;let e=n.newDoc,{head:r}=n.newSelection.main,i=e.lineAt(r);if(r>i.from+he)return n;let s=e.sliceString(i.from,r);if(!t.some(h=>h.test(s)))return n;let{state:o}=n,a=-1,l=[];for(let{head:h}of o.selection.ranges){let u=o.doc.lineAt(h);if(u.from==a)continue;a=u.from;let d=ee(o,u.from);if(d==null)continue;let g=/^\s*/.exec(u.text)[0],b=te(o,d);g!=b&&l.push({from:u.from,to:u.from+g.length,insert:b})}return l.length?[n,{changes:l,sequential:!0}]:n})}var fe=k.define(),ue=new y;function Ye(n){let t=n.firstChild,e=n.lastChild;return t&&t.to<e.from?{from:t.to,to:e.type.isError?n.to:e.from}:null}function ce(n,t,e){let r=m(n);if(r.length<e)return null;let i=r.resolveInner(e),s=null;for(let o=i;o;o=o.parent){if(o.to<=e||o.from>e)continue;if(s&&o.from<t)break;let a=o.type.prop(ue);if(a&&(o.to<r.length-50||r.length==n.doc.length||!de(o))){let l=a(o,n);l&&l.from<=e&&l.from>=t&&l.to>e&&(s=l)}}return s}function de(n){let t=n.lastChild;return t&&t.to==n.to&&t.type.isError}function V(n,t,e){for(let r of n.facet(fe)){let i=r(n,t,e);if(i)return i}return ce(n,t,e)}function Tt(n,t){let e=t.mapPos(n.from,1),r=t.mapPos(n.to,-1);return e>=r?void 0:{from:e,to:r}}var Q=K.define({map:Tt}),F=K.define({map:Tt});function Dt(n){let t=[];for(let{head:e}of n.state.selection.ranges)t.some(r=>r.from<=e&&r.to>=e)||t.push(n.lineBlockAt(e));return t}var A=ot.define({create(){return v.none},update(n,t){n=n.map(t.changes);for(let e of t.effects)e.is(Q)&&!pe(n,e.value.from,e.value.to)?n=n.update({add:[ye.range(e.value.from,e.value.to)]}):e.is(F)&&(n=n.update({filter:(r,i)=>e.value.from!=r||e.value.to!=i,filterFrom:e.value.from,filterTo:e.value.to}));if(t.selection){let e=!1,{head:r}=t.selection.main;n.between(r,r,(i,s)=>{i<r&&s>r&&(e=!0)}),e&&(n=n.update({filterFrom:r,filterTo:r,filter:(i,s)=>s<=r||i>=r}))}return n},provide:n=>w.decorations.from(n)});function Ze(n){return n.field(A,!1)||bt.empty}function z(n,t,e){var r;let i=null;return(r=n.field(A,!1))===null||r===void 0||r.between(t,e,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function pe(n,t,e){let r=!1;return n.between(t,t,(i,s)=>{i==t&&s==e&&(r=!0)}),r}function It(n,t){return n.field(A,!1)?t:t.concat(K.appendConfig.of(Nt()))}var me=n=>{for(let t of Dt(n)){let e=V(n.state,t.from,t.to);if(e)return n.dispatch({effects:It(n.state,[Q.of(e),Ot(n,e)])}),!0}return!1},ge=n=>{if(!n.state.field(A,!1))return!1;let t=[];for(let e of Dt(n)){let r=z(n.state,e.from,e.to);r&&t.push(F.of(r),Ot(n,r,!1))}return t.length&&n.dispatch({effects:t}),t.length>0};function Ot(n,t,e=!0){let r=n.state.doc.lineAt(t.from).number,i=n.state.doc.lineAt(t.to).number;return w.announce.of(`${n.state.phrase(e?"Folded lines":"Unfolded lines")} ${r} ${n.state.phrase("to")} ${i}.`)}var ke=n=>{let{state:t}=n,e=[];for(let r=0;r<t.doc.length;){let i=n.lineBlockAt(r),s=V(t,i.from,i.to);s&&e.push(Q.of(s)),r=(s?n.lineBlockAt(s.to):i).to+1}return e.length&&n.dispatch({effects:It(n.state,e)}),!!e.length},be=n=>{let t=n.state.field(A,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,n.state.doc.length,(r,i)=>{e.push(F.of({from:r,to:i}))}),n.dispatch({effects:e}),!0},_e=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:me},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ge},{key:"Ctrl-Alt-[",run:ke},{key:"Ctrl-Alt-]",run:be}],we={placeholderDOM:null,placeholderText:"\u2026"},Bt=k.define({combine(n){return kt(n,we)}});function Nt(n){let t=[A,xe];return n&&t.push(Bt.of(n)),t}var ye=v.replace({widget:new class extends Jt{toDOM(n){let{state:t}=n,e=t.facet(Bt),r=s=>{let o=n.lineBlockAt(n.posAtDOM(s.target)),a=z(n.state,o.from,o.to);a&&n.dispatch({effects:F.of(a)}),s.preventDefault()};if(e.placeholderDOM)return e.placeholderDOM(n,r);let i=document.createElement("span");return i.textContent=e.placeholderText,i.setAttribute("aria-label",t.phrase("folded code")),i.title=t.phrase("unfold"),i.className="cm-foldPlaceholder",i.onclick=r,i}}}),ve={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{}},B=class extends Qt{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}};function tn(n={}){let t=Object.assign(Object.assign({},ve),n),e=new B(t,!0),r=new B(t,!1),i=lt.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(P)!=o.state.facet(P)||o.startState.field(A,!1)!=o.state.field(A,!1)||m(o.startState)!=m(o.state))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new wt;for(let l of o.viewportLineBlocks){let h=z(o.state,l.from,l.to)?r:V(o.state,l.from,l.to)?e:null;h&&a.add(l.from,l.from,h)}return a.finish()}}),{domEventHandlers:s}=t;return[i,Kt({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(i))===null||a===void 0?void 0:a.markers)||bt.empty},initialSpacer(){return new B(t,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,a,l)=>{if(s.click&&s.click(o,a,l))return!0;let h=z(o.state,a.from,a.to);if(h)return o.dispatch({effects:F.of(h)}),!0;let u=V(o.state,a.from,a.to);return u?(o.dispatch({effects:Q.of(u)}),!0):!1}})}),Nt()]}var xe=w.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),D=class{constructor(t,e){let r;function i(a){let l=ft.newName();return(r||(r=Object.create(null)))["."+l]=a,l}let s=typeof e.all=="string"?e.all:e.all?i(e.all):void 0,o=e.scope;this.scope=o instanceof c?a=>a.prop(T)==o.data:o?a=>a==o:void 0,this.style=Xt(t.map(a=>({tag:a.tag,class:a.class||i(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=r?new ft(r):null,this.themeType=e.themeType}static define(t,e){return new D(t,e||{})}},nt=k.define(),Mt=k.define({combine(n){return n.length?[n[0]]:null}});function W(n){let t=n.facet(nt);return t.length?t:n.facet(Mt)}function en(n,t){let e=[Se],r;return n instanceof D&&(n.module&&e.push(w.styleModule.of(n.module)),r=n.themeType),t?.fallback?e.push(Mt.of(n)):r?e.push(nt.computeN([w.darkTheme],i=>i.facet(w.darkTheme)==(r=="dark")?[n]:[])):e.push(nt.of(n)),e}function nn(n,t,e){let r=W(n),i=null;if(r){for(let s of r)if(!s.scope||e&&s.scope(e)){let o=s.style(t);o&&(i=i?i+" "+o:o)}}return i}var rt=class{constructor(t){this.markCache=Object.create(null),this.tree=m(t.state),this.decorations=this.buildDeco(t,W(t.state))}update(t){let e=m(t.state),r=W(t.state),i=r!=W(t.startState);e.length<t.view.viewport.to&&!i&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||i)&&(this.tree=e,this.decorations=this.buildDeco(t.view,r))}buildDeco(t,e){if(!e||!this.tree.length)return v.none;let r=new wt;for(let{from:i,to:s}of t.visibleRanges)Yt(this.tree,e,(o,a,l)=>{r.add(o,a,this.markCache[l]||(this.markCache[l]=v.mark({class:l})))},i,s);return r.finish()}},Se=qt.high(lt.fromClass(rt,{decorations:n=>n.decorations})),rn=D.define([{tag:f.meta,color:"#7a757a"},{tag:f.link,textDecoration:"underline"},{tag:f.heading,textDecoration:"underline",fontWeight:"bold"},{tag:f.emphasis,fontStyle:"italic"},{tag:f.strong,fontWeight:"bold"},{tag:f.strikethrough,textDecoration:"line-through"},{tag:f.keyword,color:"#708"},{tag:[f.atom,f.bool,f.url,f.contentSeparator,f.labelName],color:"#219"},{tag:[f.literal,f.inserted],color:"#164"},{tag:[f.string,f.deleted],color:"#a11"},{tag:[f.regexp,f.escape,f.special(f.string)],color:"#e40"},{tag:f.definition(f.variableName),color:"#00f"},{tag:f.local(f.variableName),color:"#30a"},{tag:[f.typeName,f.namespace],color:"#085"},{tag:f.className,color:"#167"},{tag:[f.special(f.variableName),f.macroName],color:"#256"},{tag:f.definition(f.propertyName),color:"#00c"},{tag:f.comment,color:"#940"},{tag:f.invalid,color:"#f00"}]),Pe=w.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Et=1e4,Ft="()[]{}",Rt=k.define({combine(n){return kt(n,{afterCursor:!0,brackets:Ft,maxScanDistance:Et,renderMatch:Te})}}),Ae=v.mark({class:"cm-matchingBracket"}),Ce=v.mark({class:"cm-nonmatchingBracket"});function Te(n){let t=[],e=n.matched?Ae:Ce;return t.push(e.range(n.start.from,n.start.to)),n.end&&t.push(e.range(n.end.from,n.end.to)),t}var De=ot.define({create(){return v.none},update(n,t){if(!t.docChanged&&!t.selection)return n;let e=[],r=t.state.facet(Rt);for(let i of t.state.selection.ranges){if(!i.empty)continue;let s=R(t.state,i.head,-1,r)||i.head>0&&R(t.state,i.head-1,1,r)||r.afterCursor&&(R(t.state,i.head,1,r)||i.head<t.state.doc.length&&R(t.state,i.head+1,-1,r));s&&(e=e.concat(r.renderMatch(s,t.state)))}return v.set(e,!0)},provide:n=>w.decorations.from(n)}),Ie=[De,Pe];function sn(n={}){return[Rt.of(n),Ie]}function it(n,t,e){let r=n.prop(t<0?y.openedBy:y.closedBy);if(r)return r;if(n.name.length==1){let i=e.indexOf(n.name);if(i>-1&&i%2==(t<0?1:0))return[e[i+t]]}return null}function R(n,t,e,r={}){let i=r.maxScanDistance||Et,s=r.brackets||Ft,o=m(n),a=o.resolveInner(t,e);for(let l=a;l;l=l.parent){let h=it(l.type,e,s);if(h&&l.from<l.to)return Oe(n,t,e,l,h,s)}return Be(n,t,e,o,a.type,i,s)}function Oe(n,t,e,r,i,s){let o=r.parent,a={from:r.from,to:r.to},l=0,h=o?.cursor();if(h&&(e<0?h.childBefore(r.from):h.childAfter(r.to)))do if(e<0?h.to<=r.from:h.from>=r.to){if(l==0&&i.indexOf(h.type.name)>-1&&h.from<h.to)return{start:a,end:{from:h.from,to:h.to},matched:!0};if(it(h.type,e,s))l++;else if(it(h.type,-e,s)&&(l--,l==0))return{start:a,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1}}while(e<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function Be(n,t,e,r,i,s,o){let a=e<0?n.sliceDoc(t-1,t):n.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=e>0)return null;let h={from:e<0?t-1:t,to:e>0?t+1:t},u=n.doc.iterRange(t,e>0?n.doc.length:0),d=0;for(let g=0;!u.next().done&&g<=s;){let b=u.value;e<0&&(g+=b.length);let X=t+g*e;for(let C=e>0?0:b.length-1,$t=e>0?b.length:-1;C!=$t;C+=e){let Y=o.indexOf(b[C]);if(!(Y<0||r.resolve(X+C,1).type!=i))if(Y%2==0==e>0)d++;else{if(d==1)return{start:h,end:{from:X+C,to:X+C+1},matched:Y>>1==l>>1};d--}}e>0&&(g+=b.length)}return u.done?{start:h,matched:!1}:null}function pt(n,t,e,r=0,i=0){t==null&&(t=n.search(/[^\s\u00a0]/),t==-1&&(t=n.length));let s=i;for(let o=r;o<t;o++)n.charCodeAt(o)==9?s+=e-s%e:s++;return s}var G=class{constructor(t,e,r){this.string=t,this.tabSize=e,this.indentUnit=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e=this.string.charAt(this.pos),r;if(typeof t=="string"?r=e==t:r=e&&(t instanceof RegExp?t.test(e):t(e)),r)return++this.pos,e}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=pt(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){return pt(this.string,null,this.tabSize)}match(t,e,r){if(typeof t=="string"){let i=o=>r?o.toLowerCase():o,s=this.string.substr(this.pos,t.length);return i(s)==i(t)?(e!==!1&&(this.pos+=t.length),!0):null}else{let i=this.string.slice(this.pos).match(t);return i&&i.index>0?null:(i&&e!==!1&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}};function Ne(n){return{token:n.token,blankLine:n.blankLine||(()=>{}),startState:n.startState||(()=>!0),copyState:n.copyState||Me,indent:n.indent||(()=>null),languageData:n.languageData||{},tokenTable:n.tokenTable||ht}}function Me(n){if(typeof n!="object")return n;let t={};for(let e in n){let r=n[e];t[e]=r instanceof Array?r.slice():r}return t}var q=class extends c{constructor(t){let e=yt(t.languageData),r=Ne(t),i,s=new class extends gt{createParse(o,a,l){return new st(i,o,a,l)}};super(e,s,[St.of((o,a)=>this.getIndent(o,a))]),this.topNode=Ue(e),i=this,this.streamParser=r,this.stateAfter=new y({perNode:!0}),this.tokenTable=t.tokenTable?new H(r.tokenTable):Re}static define(t){return new q(t)}getIndent(t,e){let r=m(t.state),i=r.resolve(e);for(;i&&i.type!=this.topNode;)i=i.parent;if(!i)return null;let s=at(this,r,0,i.from,e),o,a;if(s?(a=s.state,o=s.pos+1):(a=this.streamParser.startState(t.unit),o=0),e-o>1e4)return null;for(;o<e;){let h=t.state.doc.lineAt(o),u=Math.min(e,h.to);if(h.length){let d=new G(h.text,t.state.tabSize,t.unit);for(;d.pos<u-h.from;)Wt(this.streamParser.token,d,a)}else this.streamParser.blankLine(a,t.unit);if(u==e)break;o=h.to+1}let{text:l}=t.lineAt(e);return this.streamParser.indent(a,/^\s*(.*)/.exec(l)[1],t)}get allowsNesting(){return!1}};function at(n,t,e,r,i){let s=e>=r&&e+t.length<=i&&t.prop(n.stateAfter);if(s)return{state:n.streamParser.copyState(s),pos:e+t.length};for(let o=t.children.length-1;o>=0;o--){let a=t.children[o],l=e+t.positions[o],h=a instanceof p&&l<i&&at(n,a,l,r,i);if(h)return h}return null}function Ut(n,t,e,r,i){if(i&&e<=0&&r>=t.length)return t;!i&&t.type==n.topNode&&(i=!0);for(let s=t.children.length-1;s>=0;s--){let o=t.positions[s],a=t.children[s],l;if(o<r&&a instanceof p){if(!(l=Ut(n,a,e-o,r-o,i)))break;return i?new p(t.type,t.children.slice(0,s).concat(l),t.positions.slice(0,s+1),o+l.length):l}}return null}function Ee(n,t,e,r){for(let i of t){let s=i.from+(i.openStart?25:0),o=i.to-(i.openEnd?25:0),a=s<=e&&o>e&&at(n,i.tree,0-i.offset,e,o),l;if(a&&(l=Ut(n,i.tree,e+i.offset,a.pos+i.offset,!1)))return{state:a.state,tree:l}}return{state:n.streamParser.startState(r?j(r):4),tree:p.empty}}var st=class{constructor(t,e,r,i){this.lang=t,this.input=e,this.fragments=r,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let s=x.get(),o=i[0].from,{state:a,tree:l}=Ee(t,r,o,s?.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let h=0;h<l.children.length;h++)this.chunks.push(l.children[h]),this.chunkPos.push(l.positions[h]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(j(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let t=x.get(),e=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(e,this.chunkStart+2048);for(t&&(r=Math.min(r,t.viewport.to));this.parsedPos<r;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)e==`
`&&(e="");else{let r=e.indexOf(`
`);r>-1&&(e=e.slice(0,r))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),r=t+e.length;for(let i=this.rangeIndex;;){let s=this.ranges[i].to;if(s>=r||(e=e.slice(0,s-(r-e.length)),i++,i==this.ranges.length))break;let o=this.ranges[i].from,a=this.lineAfter(o);e+=a,r=o+a.length}return{line:e,end:r}}skipGapsTo(t,e,r){for(;;){let i=this.ranges[this.rangeIndex].to,s=t+e;if(r>0?i>s:i>=s)break;let o=this.ranges[++this.rangeIndex].from;e+=o-i}return e}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(t,e,r,i,s){if(this.ranges.length>1){s=this.skipGapsTo(e,s,1),e+=s;let o=this.chunk.length;s=this.skipGapsTo(r,s,-1),r+=s,i+=this.chunk.length-o}return this.chunk.push(t,e,r,i),s}parseLine(t){let{line:e,end:r}=this.nextLine(),i=0,{streamParser:s}=this.lang,o=new G(e,t?t.state.tabSize:4,t?j(t.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=Wt(s.token,o,this.state);if(a&&(i=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,4,i)),o.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=p.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Fe,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new p(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new p(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function Wt(n,t,e){t.start=t.pos;for(let r=0;r<10;r++){let i=n(t,e);if(t.pos>t.start)return i}throw new Error("Stream parser failed to advance stream.")}var ht=Object.create(null),E=[J.none],Fe=new zt(E),mt=[],Lt=Object.create(null);for(let[n,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Lt[n]=jt(ht,t);var H=class{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),Lt)}resolve(t){return t?this.table[t]||(this.table[t]=jt(this.extra,t)):0}},Re=new H(ht);function tt(n,t){mt.indexOf(n)>-1||(mt.push(n),console.warn(t))}function jt(n,t){let e=null;for(let s of t.split(".")){let o=n[s]||f[s];o?typeof o=="function"?e?e=o(e):tt(s,`Modifier ${s} used at start of tag`):e?tt(s,`Tag ${s} used as modifier`):e=o:tt(s,`Unknown highlighting tag ${s}`)}if(!e)return 0;let r=t.replace(/ /g,"_"),i=J.define({id:E.length,name:r,props:[Zt({[r]:e})]});return E.push(i),i.id}function Ue(n){let t=J.define({id:E.length,name:"Document",props:[T.add(()=>n)]});return E.push(t),t}export{D as HighlightStyle,$ as IndentContext,N as LRLanguage,c as Language,L as LanguageDescription,dt as LanguageSupport,x as ParseContext,q as StreamLanguage,G as StringStream,M as TreeIndentContext,sn as bracketMatching,Nt as codeFolding,Qe as continuedIndent,rn as defaultHighlightStyle,yt as defineLanguageFacet,Je as delimitedIndent,_t as ensureSyntaxTree,Ke as flatIndent,ke as foldAll,me as foldCode,Q as foldEffect,tn as foldGutter,Ye as foldInside,_e as foldKeymap,ue as foldNodeProp,fe as foldService,V as foldable,Ze as foldedRanges,Ge as forceParsing,j as getIndentUnit,ee as getIndentation,nn as highlightingFor,ne as indentNodeProp,Xe as indentOnInput,St as indentService,te as indentString,Pt as indentUnit,P as language,T as languageDataProp,R as matchBrackets,en as syntaxHighlighting,qe as syntaxParserRunning,m as syntaxTree,ze as syntaxTreeAvailable,be as unfoldAll,ge as unfoldCode,F as unfoldEffect};
//# sourceMappingURL=language.mjs.map